#!/bin/bash
echo -e "\e[93m                     ____            _       "
echo -e "\e[93m ___  ___ __ _ _ __ |  _ \ ___  _ __| |_ ___ "
echo -e "\e[93m/ __|/ __/ _\` | '_ \\| |_) / _ \\| '__| __/ __|"
echo -e "\e[93m\\__ \\ (_| (_| | | | |  __/ (_) | |  | |_\\__ \\"
echo -e "\e[93m|___/\\___\\__,_|_| |_|_|   \\___/|_|   \\__|___/"
echo -e "\e[93m "
echo -e "\e[93m             created by bitc0de              " 
echo -e "\e[93m --------------------------------------------\e[94m"

#---- VARIABLES
port21="https://book.hacktricks.xyz/pentesting/pentesting-ftp"
port22="https://book.hacktricks.xyz/pentesting/pentesting-ssh"
port23="https://book.hacktricks.xyz/pentesting/pentesting-telnet"
port25="https://book.hacktricks.xyz/pentesting/pentesting-smtp"
port43="https://book.hacktricks.xyz/pentesting/43-pentesting-whois"
port53="https://book.hacktricks.xyz/pentesting/pentesting-dns"
port69="https://book.hacktricks.xyz/pentesting/69-udp-tftp"
port79="https://book.hacktricks.xyz/pentesting/pentesting-finger"
port80="https://book.hacktricks.xyz/pentesting/pentesting-web"
port88="https://book.hacktricks.xyz/pentesting/pentesting-kerberos-88"
port110="https://book.hacktricks.xyz/pentesting/pentesting-pop"
port111="https://book.hacktricks.xyz/pentesting/pentesting-rpcbind"
port113="https://book.hacktricks.xyz/pentesting/113-pentesting-ident"
port123="https://book.hacktricks.xyz/pentesting/pentesting-ntp"
port135="https://book.hacktricks.xyz/pentesting/135-pentesting-msrpc"
port137="https://book.hacktricks.xyz/pentesting/137-138-139-pentesting-netbios"
port138="https://book.hacktricks.xyz/pentesting/137-138-139-pentesting-netbios"
port139="https://book.hacktricks.xyz/pentesting/137-138-139-pentesting-netbios and https://book.hacktricks.xyz/pentesting/pentesting-smb"
port143="https://book.hacktricks.xyz/pentesting/pentesting-imap"
port161="https://book.hacktricks.xyz/pentesting/pentesting-snmp"
port162="https://book.hacktricks.xyz/pentesting/pentesting-snmp"
port194="https://book.hacktricks.xyz/pentesting/pentesting-irc"
port264="https://book.hacktricks.xyz/pentesting/pentesting-264-check-point-firewall-1"
port389="https://book.hacktricks.xyz/pentesting/pentesting-ldap"
port443="https://book.hacktricks.xyz/pentesting/pentesting-web"
port445="https://book.hacktricks.xyz/pentesting/pentesting-smb"
port465="https://book.hacktricks.xyz/pentesting/pentesting-smtp"
port500="https://book.hacktricks.xyz/pentesting/ipsec-ike-vpn-pentesting"
port502="https://book.hacktricks.xyz/pentesting/pentesting-modbus"
port512="https://book.hacktricks.xyz/pentesting/512-pentesting-rexec"
port513="https://book.hacktricks.xyz/pentesting/pentesting-rlogin"
port514="https://book.hacktricks.xyz/pentesting/pentesting-rsh"
port515="https://book.hacktricks.xyz/pentesting/515-pentesting-line-printer-daemon-lpd"
port548="https://book.hacktricks.xyz/pentesting/584-pentesting-afp"
port554="https://book.hacktricks.xyz/pentesting/554-8554-pentesting-rtsp"
port587="https://book.hacktricks.xyz/pentesting/pentesting-smtp"
port593="https://book.hacktricks.xyz/pentesting/135-pentesting-msrpc"
port623="https://book.hacktricks.xyz/pentesting/623-udp-ipmi"
port631="https://book.hacktricks.xyz/pentesting/pentesting-631-internet-printing-protocol-ipp"
port636="https://book.hacktricks.xyz/pentesting/pentesting-ldap"
port873="https://book.hacktricks.xyz/pentesting/873-pentesting-rsync"
port993="https://book.hacktricks.xyz/pentesting/pentesting-imap"
port995="https://book.hacktricks.xyz/pentesting/pentesting-pop"
port1026="https://book.hacktricks.xyz/pentesting/1026-pentesting-rusersd"
port1050="https://book.hacktricks.xyz/pentesting/1099-pentesting-java-rmi"
port1080="https://book.hacktricks.xyz/pentesting/1080-pentesting-socks"
port1098="https://book.hacktricks.xyz/pentesting/1099-pentesting-java-rmi"
port1099="https://book.hacktricks.xyz/pentesting/1099-pentesting-java-rmi"
port1433="https://book.hacktricks.xyz/pentesting/pentesting-mssql-microsoft-sql-server"
port1521="https://book.hacktricks.xyz/pentesting/1521-1522-1529-pentesting-oracle-listener"
port1522="https://book.hacktricks.xyz/pentesting/1521-1522-1529-pentesting-oracle-listener"
port1529="https://book.hacktricks.xyz/pentesting/1521-1522-1529-pentesting-oracle-listener"
port1723="https://book.hacktricks.xyz/pentesting/1723-pentesting-pptp"
port1883="https://book.hacktricks.xyz/pentesting/1883-pentesting-mqtt-mosquitto"
port2049="https://book.hacktricks.xyz/pentesting/nfs-service-pentesting"
port2301="https://book.hacktricks.xyz/pentesting/pentesting-compaq-hp-insight-manager"
port2381="https://book.hacktricks.xyz/pentesting/pentesting-compaq-hp-insight-manager"
port2375="https://book.hacktricks.xyz/pentesting/2375-pentesting-docker"
port2376="https://book.hacktricks.xyz/pentesting/2375-pentesting-docker"
port3128="https://book.hacktricks.xyz/pentesting/3128-pentesting-squid"
port3260="https://book.hacktricks.xyz/pentesting/3260-pentesting-iscsi"
port3268="https://book.hacktricks.xyz/pentesting/pentesting-ldap"
port3269="https://book.hacktricks.xyz/pentesting/pentesting-ldap"
port3299="https://book.hacktricks.xyz/pentesting/3299-pentesting-saprouter"
port3306="https://book.hacktricks.xyz/pentesting/pentesting-mysql"
port3389="https://book.hacktricks.xyz/pentesting/pentesting-rdp"
port3632="https://book.hacktricks.xyz/pentesting/3632-pentesting-distcc"
port3690="https://book.hacktricks.xyz/pentesting/3690-pentesting-subversion-svn-server"
port4369="https://book.hacktricks.xyz/pentesting/4369-pentesting-erlang-port-mapper-daemon-epmd"
port5000="https://book.hacktricks.xyz/pentesting/5000-pentesting-docker-registry"
port5353="https://book.hacktricks.xyz/pentesting/5353-udp-multicast-dns-mdns"
port5432="https://book.hacktricks.xyz/pentesting/pentesting-postgresql"
port5433="https://book.hacktricks.xyz/pentesting/pentesting-postgresql"
port5601="https://book.hacktricks.xyz/pentesting/5601-pentesting-kibana"
port5671="https://book.hacktricks.xyz/pentesting/5671-5672-pentesting-amqp"
port5672="https://book.hacktricks.xyz/pentesting/5671-5672-pentesting-amqp"
port5800="https://book.hacktricks.xyz/pentesting/pentesting-vnc"
port5801="https://book.hacktricks.xyz/pentesting/pentesting-vnc"
port5900="https://book.hacktricks.xyz/pentesting/pentesting-vnc"
port5901="https://book.hacktricks.xyz/pentesting/pentesting-vnc"
port5984="https://book.hacktricks.xyz/pentesting/5984-pentesting-couchdb"
port5985="https://book.hacktricks.xyz/pentesting/5985-5986-pentesting-winrm"
port5986="https://book.hacktricks.xyz/pentesting/5985-5986-pentesting-winrm"
port6000="https://book.hacktricks.xyz/pentesting/6000-pentesting-x11"
port6379="https://book.hacktricks.xyz/pentesting/6379-pentesting-redis"
port6666="https://book.hacktricks.xyz/pentesting/pentesting-irc"
port6660="https://book.hacktricks.xyz/pentesting/pentesting-irc"
port6984="https://book.hacktricks.xyz/pentesting/5984-pentesting-couchdb"
port7000="https://book.hacktricks.xyz/pentesting/pentesting-irc"
port8009="https://book.hacktricks.xyz/pentesting/8009-pentesting-apache-jserv-protocol-ajp"
port8089="https://book.hacktricks.xyz/pentesting/8089-splunkd"
port8554="https://book.hacktricks.xyz/pentesting/554-8554-pentesting-rtsp"
port9000="https://book.hacktricks.xyz/pentesting/9000-pentesting-fastcgi"
port9001="https://book.hacktricks.xyz/pentesting/9001-pentesting-hsqldb"
port9042="https://book.hacktricks.xyz/pentesting/cassandra"
port9100="https://book.hacktricks.xyz/pentesting/9100-pjl"
port9160="https://book.hacktricks.xyz/pentesting/cassandra"
port9200="https://book.hacktricks.xyz/pentesting/9200-pentesting-elasticsearch"
port10000="https://book.hacktricks.xyz/pentesting/10000-network-data-management-protocol-ndmp"
port10161="https://book.hacktricks.xyz/pentesting/pentesting-snmp"
port10162="https://book.hacktricks.xyz/pentesting/pentesting-snmp"
port11211="https://book.hacktricks.xyz/pentesting/11211-memcache"
port15672="https://book.hacktricks.xyz/pentesting/15672-pentesting-rabbitmq-management"
port27017="https://book.hacktricks.xyz/pentesting/27017-27018-mongodb"
port27018="https://book.hacktricks.xyz/pentesting/27017-27018-mongodb"
port47808="https://book.hacktricks.xyz/pentesting/47808-udp-bacnet"
port44818="https://book.hacktricks.xyz/pentesting/44818-ethernetip"
port50030="https://book.hacktricks.xyz/pentesting/50030-50060-50070-50075-50090-pentesting-hadoop"
port50060="https://book.hacktricks.xyz/pentesting/50030-50060-50070-50075-50090-pentesting-hadoop"
port50070="https://book.hacktricks.xyz/pentesting/50030-50060-50070-50075-50090-pentesting-hadoop"
port50075="https://book.hacktricks.xyz/pentesting/50030-50060-50070-50075-50090-pentesting-hadoop"
port50090="https://book.hacktricks.xyz/pentesting/50030-50060-50070-50075-50090-pentesting-hadoop"



echo -e "\e[93m[*]Scanning ports...\e[94m" 
nmap -p- -Pn --min-rate 10000 --stats-every 5s $1 -oG openPorts 2>/dev/null
ports=$(egrep -v "^#|Status: Up" openPorts| cut -d ' ' -f4- | tr ',' '\n' | \sed -e 's/^[ \t]*//' | awk -F '/' '{print $1}' | tr '\n' ',' | rev | cut -c 2- | rev)
echo "$ports" | xclip -sel clip
IFS=',' read -r -a array <<< "$ports"
echo -e "\e[93m ---RESULTS---"
echo -e "\n"
echo -e "\e[93m[*] Ports copied to clipboard!"
if [[ "$1" =~ ^[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+$ ]];then
    for i in ${array[@]};do
        pre="port"
        pre+="$i"
        if [ "$pre" == "port${i}" ];then
            echo -e "\n\e[93mPort \e[36m$i"
            echo -e "\e[93mEnumerate port $i: \e[36m${!pre}"
            if [ "$i" == "21" ];then
                echo -e "\e[93m[*]Command bruteforce: \e[36mhydra -l username -P path/to/wordlist.txt IP ftp"
                echo -e "\e[93m[*]Command anonymous user: \e[36mftp anonymous@IP"
            elif [ "$i" == "53" ];then
                echo -e "\e[93m[*]Command DNS discovery: \e[36msudo nmap --script=broadcast-dns-service-discovery -sU -p 53 IP"
            elif [ "$i" == "80" ];then
                echo -e "\e[93m[*]Command nikto: \e[36mnikto --host http://IP"
                echo -e "\e[93m[*]Command whatweb: \e[36mwhatweb http://IP"
            fi
            ((contador=contador+1))
            echo -e "\e[93m-----------------------"                                                                                                                                          
        fi
     done
else
    echo -e "\e[31mUsage: scanPorts IP"
    echo -e "\e[31mExample: scanPorts 10.10.10.161"
fi
